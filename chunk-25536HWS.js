import{O as l,Oa as d,Ta as p,f as s,ub as g,vb as f,wb as u}from"./chunk-C3XY3FDI.js";var m=class r{observeElementOnce(e,t,n={threshold:.5,rootMargin:"0px"}){if(!e){console.error("Element reference is invalid.");return}let i=new IntersectionObserver(o=>{o.forEach(a=>{a.isIntersecting&&(t(!0),i.unobserve(e.nativeElement))})},n);i.observe(e.nativeElement)}static \u0275fac=function(t){return new(t||r)};static \u0275prov=l({token:r,factory:r.\u0275fac,providedIn:"root"})};var E=r=>typeof r=="string"?r:r.src,M=({amount:r=3,format:e="array",group:t=20,sample:n=10}={})=>({amount:r,format:e,group:t,sample:n}),x=(r,e)=>{var t=r.map(n=>{var i=Array.isArray(n)?n:n.split(",").map(Number);return e.format==="hex"?O(i):i});return e.amount===1||t.length===1?t[0]:t},c=(r,e)=>{var t=Math.round(r/e)*e;return Math.min(t,255)},O=r=>"#"+r.map(e=>{var t=e.toString(16);return t.length===1?"0"+t:t}).join(""),A=r=>new Promise((e,t)=>{var n=document.createElement("canvas"),i=n.getContext("2d"),o=new Image;o.onload=()=>{n.height=o.height,n.width=o.width,i.drawImage(o,0,0);var a=i.getImageData(0,0,o.width,o.height).data;e(a)},o.onerror=()=>t(Error("Image loading failed.")),o.crossOrigin="",o.src=r});var R=(r,e)=>{for(var t=4*e.sample,n={},i=0;i<r.length;i+=t){var o=[c(r[i],e.group),c(r[i+1],e.group),c(r[i+2],e.group)].join();n[o]=n[o]?n[o]+1:1}return x(Object.entries(n).sort(([a,y],[j,I])=>y>I?-1:1).slice(0,e.amount).map(([a])=>a),e)},V=(r,e,t)=>new Promise((n,i)=>A(E(e)).then(o=>n(r(o,M(t)))).catch(o=>i(o)));var b=(r,e)=>V(R,r,e);function v(r){return s(this,null,function*(){let e=document.getElementById(r);if(e){let t=yield b(e,{amount:10,sample:500}),n;for(let i of t)if(Array.isArray(i)&&!S(i)){n=i;break}if(n)return`rgb(${n[0]}, ${n[1]}, ${n[2]})`}})}function S(r,e=10){return Math.abs(r[0]-r[1])<=e&&Math.abs(r[1]-r[2])<=e&&Math.abs(r[0]-r[2])<=e}var P=["card"],h=class r{constructor(e){this.visibilityObserverService=e}cardElement;backgroundColor="";isRevealed=!1;ngAfterViewInit(){return s(this,null,function*(){yield this.initializeGradient(),this.observeCardVisibility()})}initializeGradient(){return s(this,null,function*(){let e=this.getImageId();this.backgroundColor=(yield v(e))||"#000"})}observeCardVisibility(){this.cardElement&&this.visibilityObserverService.observeElementOnce(this.cardElement,e=>{this.isRevealed=e})}encodeURIComponent(e){return encodeURIComponent(e)}static \u0275fac=function(t){return new(t||r)(d(m))};static \u0275cmp=p({type:r,selectors:[["ng-component"]],viewQuery:function(t,n){if(t&1&&g(P,5),t&2){let i;f(i=u())&&(n.cardElement=i.first)}},decls:0,vars:0,template:function(t,n){},encapsulation:2})};export{m as a,h as b};
